# This class is used to create a node for the circular linked list
# Each node stores the stop name and the address of next node
class Node:
    def __init__(self, name):
        self.name = name      # store stop name
        self.next = None      # pointer to next node


# This class is used to create the circular linked list for bus route
class BusRoute:
    def __init__(self):
        self.head = None      # head points to first stop


    # This function adds a new stop in the route
    def add_stop(self, name):
        global passengers
        new_node = Node(name)     # create new node

        # If route is empty then make first node
        if self.head is None:
            self.head = new_node
            new_node.next = self.head     # circular link
            passengers[0].append(0)       # add passenger count
            print(name, "added as first stop")
            return

        # Move to last stop
        temp = self.head
        while temp.next != self.head:
            temp = temp.next

        # Insert at end and make circular
        temp.next = new_node
        new_node.next = self.head
        passengers[0].append(0)
        print(name, "added")


    # This function deletes a stop from the route
    def delete_stop(self, name):
        global passengers

        # If route is empty
        if self.head is None:
            print("Route empty")
            return

        temp = self.head
        prev = None
        index = 0

        # If first stop needs to be deleted
        if temp.name == name:
            # If only one stop exists
            if temp.next == self.head:
                self.head = None
                passengers[0].pop(0)
                print(name, "deleted")
                return

            # Find last node to fix circular link
            last = self.head
            while last.next != self.head:
                last = last.next

            self.head = temp.next
            last.next = self.head
            passengers[0].pop(0)
            print(name, "deleted")
            return

        # If stop is not the first one
        while temp.next != self.head:
            prev = temp
            temp = temp.next
            index = index + 1

            if temp.name == name:
                prev.next = temp.next     # remove node
                passengers[0].pop(index)
                print(name, "deleted")
                return

        print("Stop not found")


    # This function searches a stop in the route
    def search_stop(self, name):
        # If route is empty
        if self.head is None:
            print("Route empty")
            return

        temp = self.head
        pos = 1

        # Loop until we come back to first stop
        while True:
            if temp.name == name:
                print(name, "found at position", pos)
                return

            temp = temp.next
            pos = pos + 1

            if temp == self.head:
                break

        print("Stop not found")


    # This function displays all stops in the route
    def display_route(self):
        if self.head is None:
            print("Route empty")
            return

        temp = self.head
        print("Bus Route:")

        # Traverse circular linked list
        while True:
            print(temp.name, "->", end=" ")
            temp = temp.next

            if temp == self.head:
                break

        print("(circular)")


    # This function simulates the bus movement
    def simulate_bus(self):
        if self.head is None:
            print("Route empty")
            return

        temp = self.head
        print("Bus Simulation:")

        while True:
            print("Bus arrived at", temp.name)
            temp = temp.next

            if temp == self.head:
                break


# --------------- 2D Array for Passenger Data ----------------
# passengers[0] represents route
# passengers[0][i] represents passengers at ith stop
passengers = [[]]


# This function displays passenger count at each stop
def show_passengers():
    if len(passengers[0]) == 0:
        print("No passenger data")
        return

    print("Passengers at stops:")
    for i in range(len(passengers[0])):
        print("Stop", i + 1, ":", passengers[0][i])


# This function adds passengers to a stop
def add_passengers():
    show_passengers()
    stop = int(input("Enter stop number: ")) - 1
    count = int(input("Enter passengers: "))

    if stop >= 0 and stop < len(passengers[0]):
        passengers[0][stop] = passengers[0][stop] + count
        print("Passengers added")
    else:
        print("Invalid stop number")


# This function finds overcrowded stops
def find_overcrowded(limit):
    found = False

    for i in range(len(passengers[0])):
        if passengers[0][i] > limit:
            print("Stop", i + 1, "overcrowded:", passengers[0][i])
            found = True

    if found == False:
        print("No overcrowded stops")


# ---------------- Main Program ----------------
route = BusRoute()

n = int(input("Enter number of stops: "))

# Taking stop names from user
for i in range(n):
    name = input("Enter stop name: ")
    route.add_stop(name)

# Taking initial passenger data
for i in range(len(passengers[0])):
    passengers[0][i] = int(input("Enter passengers at stop " + str(i + 1) + ": "))

# Menu driven program
while True:
    print("\n1 Add Stop")
    print("2 Delete Stop")
    print("3 Search Stop")
    print("4 Display Route")
    print("5 Passenger Data")
    print("6 Add Passengers")
    print("7 Overcrowded Stops")
    print("8 Simulate Bus")
    print("9 Exit")

    choice = input("Enter choice: ")

    if choice == "1":
        route.add_stop(input("Stop name: "))

    elif choice == "2":
        route.delete_stop(input("Stop name: "))

    elif choice == "3":
        route.search_stop(input("Stop name: "))

    elif choice == "4":
        route.display_route()

    elif choice == "5":
        show_passengers()

    elif choice == "6":
        add_passengers()

    elif choice == "7":
        find_overcrowded(int(input("Enter limit: ")))

    elif choice == "8":
        route.simulate_bus()

    elif choice == "9":
        print("Program ended")
        break

    else:
        print("Invalid choice")