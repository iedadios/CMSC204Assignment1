# ---------- BUS CONFIGURATION ----------
ROWS = 10
COLS = 5
MAX_CAPACITY = 50

# 10x5 seating layout (0 = empty, 1 = occupied)
bus_seats = [[0 for _ in range(COLS)] for _ in range(ROWS)]


# ---------- CIRCULAR LINKED LIST FOR STOPS ----------
class StopNode:
    def __init__(self, name):
        self.name = name
        self.next = None  # points to the next stop


# Initialize 5 fixed stops in a circular linked list
stop_names = ["Stop A", "Stop B", "Stop C", "Stop D", "Stop E"]
head_stop = None
prev_node = None

for name in stop_names:
    node = StopNode(name)
    if not head_stop:
        head_stop = node
    if prev_node:
        prev_node.next = node
    prev_node = node

# Make it circular
prev_node.next = head_stop

# Keep track of the bus's current stop
current_stop = head_stop


# ---------- SEAT FUNCTIONS ----------
def count_available_seats():
    count = 0
    for row in bus_seats:
        for seat in row:
            if seat == 0:
                count += 1
    return count


def board_passengers_at_stop():
    global current_stop

    stop_name = current_stop.name
    print(f"\nBus arrived at {stop_name}")

    try:
        num = int(input("Enter number of passengers boarding at this stop: "))
    except ValueError:
        print("Invalid input. No passengers boarded.")
        num = 0

    available = count_available_seats()

    if available == 0:
        print("Bus is FULL! No passengers can board.")
    elif num <= 0:
        print("No passengers boarded.")
    else:
        if num > available:
            print(f"Only {available} seats available.")
            num = available

        added = 0
        for i in range(ROWS):
            for j in range(COLS):
                if bus_seats[i][j] == 0 and added < num:
                    bus_seats[i][j] = 1
                    added += 1

        print(f"{added} passenger(s) boarded at {stop_name}")

    # Move to next stop
    current_stop = current_stop.next
    print(f"Next stop: {current_stop.name}")


def display_status():
    occupied = MAX_CAPACITY - count_available_seats()

    # Traverse circular linked list to get all stops
    stops_list = []
    node = head_stop
    while True:
        stops_list.append(node.name)
        node = node.next
        if node == head_stop:
            break

    print("\n----- BUS STATUS -----")
    print(f"Current Stop: {current_stop.name}")
    print(f"Total Stops: {len(stops_list)}")
    print("Route:", " â†’ ".join(stops_list))
    print(f"Occupied Seats: {occupied}")
    print(f"Available Seats: {count_available_seats()}/{MAX_CAPACITY}")
    print("----------------------\n")


# ---------- OPTIONAL ADDITIONAL STOPS (MAX 2) ----------
def add_additional_stop():
    global prev_node
    # Count existing stops
    count = 0
    node = head_stop
    while True:
        count += 1
        node = node.next
        if node == head_stop:
            break

    if count >= 7:
        print("Maximum of 2 additional stops already added.\n")
        return

    new_name = input("Enter name of new stop: ")
    new_node = StopNode(new_name)

    # Insert new node after last node (prev_node points to last)
    new_node.next = head_stop
    prev_node.next = new_node
    prev_node = new_node  # update last node pointer

    print(f"{new_name} added to route.\n")


# ---------- MENU ----------
def menu():
    while True:
        print("===== SMART BUS SYSTEM =====")
        print("1. Board Passengers at Current Stop")
        print("2. Display Bus Status")
        print("3. Add Additional Stop (Max 2)")
        print("4. Exit")

        choice = input("Enter choice (1-4): ")

        if choice == "1":
            board_passengers_at_stop()
        elif choice == "2":
            display_status()
        elif choice == "3":
            add_additional_stop()
        elif choice == "4":
            print("Exiting system.")
            break
        else:
            print("Invalid choice.\n")


# Run system
menu()
